<style type="text/css">
    #picture_many {
        width: 100%;
        height: 120px;
        margin: 0px auto;
        overflow: auto;
    }

    #picture_many_style {
        float: left;
        width: 25%;
        height: 80px;
    }

    .picture_many_ok {
        width: 60px;
        height: 60px;
        margin: 10px auto;
        background-image: url("{MODULE_URL}public/images/upload.png");
        background-size: 100% 100%;
    }

    .picture_many_pic {
        width: 60px;
        height: 60px;
        margin: 10px auto;
    }

    .picture_many_pic img {
        width: 100%;
        height: 100%;
    }
</style>

<div id="picture_many">
    <div id="picture_many_style">
        <div class="picture_many_ok"></div>
    </div>
    <!--
    <div id="picture_many_style"><div class="picture_many_pic"></div></div>
    -->
</div>


<script>
    wx.ready(function () {

//ѡ����Ƭ��ʼ
        $(".picture_many_ok").click(function () {
            wx.chooseImage({
                count: 1, // Ĭ��9
                sizeType: ['original', 'compressed'], // ����ָ����ԭͼ����ѹ��ͼ��Ĭ�϶��߶���
                sourceType: ['album', 'camera'], // ����ָ����Դ����ỹ�������Ĭ�϶��߶���
                success: function (res) {
                    var localIds = res.localIds; // ����ѡ����Ƭ�ı���ID�б�localId������Ϊimg��ǩ��src������ʾͼƬ
                    uploadImage(localIds);
                }
            });
        });
//ѡ����Ƭ����


//�ϴ���Ƭ��ʼ
        function uploadImage(e) {
            for (var i = 0; i < e.length; i++) {
                wx.uploadImage({
                    localId: e[i], // ��Ҫ�ϴ���ͼƬ�ı���ID����chooseImage�ӿڻ��
                    isShowProgressTips: 1, // Ĭ��Ϊ1����ʾ������ʾ
                    success: function (res) {
                        var serverId = res.serverId; // ����ͼƬ�ķ�������ID
                        alert(serverId);
                        downloadImage(serverId);

                    }
                });
            }
        }

//�ϴ���Ƭ����

//������Ƭ��ʼ
        function downloadImage(m) {
            $.post("{php echo $this->createMobileUrl('download',array('type'=>'1'));}",
                {
                    media_id: m,

                },
                function (data, status) {
                    $("#picture_many").append("<div id='picture_many_style'><div class='picture_many_pic'><img src='{$_W['attachurl']}" + data + "'/></div><input type='hidden' name='picture[]' value='" + data + "'/></div>");
                    //��ʼ

                    //����
                });
        }

//������Ƭ����

    });
</script>